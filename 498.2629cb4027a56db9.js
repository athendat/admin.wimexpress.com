"use strict";(self.webpackChunkwimexpress=self.webpackChunkwimexpress||[]).push([[498],{1498:(ue,_,n)=>{n.r(_),n.d(_,{WeightsModule:()=>me});var x=n(8277),m=n(3238),u=n(9116),C=n(3786),a=n(4006),b=n(8739),Z=n(6308),w=n(9646),y=n(7579),T=n(6451),l=n(2722),I=n(3900),W=n(7489),F=n(5439),k=n(4787),Q=n(1635),J=n(6443),U=n(6428),S=n(3844),e=n(4650),Y=n(1927),M=n(1683),A=n(3758),R=n(9653),h=n(6895),E=n(4098),N=n(4859),p=n(148),q=n(7392),d=n(9549),D=n(4144),f=n(5655),L=n(4385),B=n(266),O=n(1066);const V=["htmlWeightList"];function $(i,s){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," El mes de la disponibilidad es obligatorio. "),e.qZA())}function z(i,s){if(1&i&&(e.ynx(0),e.TgZ(1,"mat-option",21),e._uU(2),e.qZA(),e.BQk()),2&i){const t=s.$implicit;e.xp6(1),e.Q6J("value",t._id),e.xp6(1),e.Oqu(t.name)}}function G(i,s){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," El operador es obligatorio. "),e.qZA())}function j(i,s){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," El tipo de disponibilidad es obligatorio. "),e.qZA())}function H(i,s){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," La disponibilidad es obligatoria. "),e.qZA())}function K(i,s){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",36),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.saveWeight())}),e._UZ(2,"mat-icon",37),e.TgZ(3,"span",38),e._uU(4,"Guardar"),e.qZA()(),e.BQk()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("disabled",t.weightForm.invalid),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:save")}}function P(i,s){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",36),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.updateWeight())}),e._UZ(2,"mat-icon",37),e.TgZ(3,"span",38),e._uU(4,"Actualizar"),e.qZA()(),e.BQk()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("disabled",t.weightForm.invalid),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:save")}}function X(i,s){if(1&i&&(e.ynx(0),e._UZ(1,"mat-icon",50),e.BQk()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("svgIcon","mat_solid:directions_boat")("matTooltip",t.type)}}function ee(i,s){if(1&i&&(e.ynx(0),e._UZ(1,"mat-icon",50),e.BQk()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("svgIcon","mat_solid:flight_takeoff")("matTooltip",t.type)}}function te(i,s){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",45),e._UZ(2,"div"),e.TgZ(3,"div",42),e._uU(4),e.ALo(5,"date"),e.qZA(),e.TgZ(6,"div",46),e._uU(7),e.qZA(),e.TgZ(8,"div",47),e.YNc(9,X,2,2,"ng-container",19),e.YNc(10,ee,2,2,"ng-container",19),e.qZA(),e.TgZ(11,"div",46),e._uU(12),e.ALo(13,"number"),e.qZA(),e.TgZ(14,"div",48)(15,"button",49),e.NdJ("click",function(){const c=e.CHM(t).$implicit,g=e.oxw(4);return e.KtG(g.editWeight(c))}),e._UZ(16,"mat-icon",31),e.qZA(),e.TgZ(17,"button",49),e.NdJ("click",function(){const c=e.CHM(t).$implicit,g=e.oxw(4);return e.KtG(g.deleteWeight(c))}),e._UZ(18,"mat-icon",31),e.qZA()()(),e.BQk()}if(2&i){const t=s.$implicit;e.xp6(4),e.hij(" ",e.xi3(5,7,t.month,"MM/yyyy")," "),e.xp6(3),e.hij(" ",t.courierId.name," "),e.xp6(2),e.Q6J("ngIf","Mar\xedtimo"===t.type),e.xp6(1),e.Q6J("ngIf","A\xe9reo"===t.type),e.xp6(2),e.hij(" ",e.xi3(13,10,t.availability,"1.2-2")," kg "),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:pencil"),e.xp6(2),e.Q6J("svgIcon","heroicons_solid:trash")}}function ie(i,s){if(1&i&&(e.ynx(0),e.YNc(1,te,19,13,"ng-container",44),e.BQk()),2&i){const t=s.ngIf,o=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t)("ngForTrackBy",o.trackByFn)}}const oe=function(i){return{"pointer-events-none":i}},ne=function(){return[5,10,25,100]};function re(i,s){if(1&i&&(e.ynx(0),e.TgZ(1,"div",40)(2,"div",41),e._UZ(3,"div"),e.TgZ(4,"div",42),e._uU(5," Mes "),e.qZA(),e.TgZ(6,"div",42),e._uU(7," Operador "),e.qZA(),e.TgZ(8,"div",42),e._uU(9," Tipo "),e.qZA(),e.TgZ(10,"div",42),e._uU(11," Disponibilidad "),e.qZA(),e.TgZ(12,"div",42),e._uU(13," Acciones "),e.qZA()(),e.YNc(14,ie,2,2,"ng-container",19),e.ALo(15,"async"),e._UZ(16,"mat-paginator",43),e.qZA(),e.BQk()),2&i){const t=e.oxw(2);e.xp6(14),e.Q6J("ngIf",e.lcZ(15,7,t.weights$)),e.xp6(2),e.Q6J("ngClass",e.VKq(9,oe,t.isLoading))("length",t.pagination.length)("pageIndex",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.DdM(11,ne))("showFirstLastButtons",!0)}}function se(i,s){if(1&i&&(e.ynx(0),e.YNc(1,re,17,12,"ng-container",39),e.BQk()),2&i){const t=s.ngIf;e.oxw();const o=e.MAs(67);e.xp6(1),e.Q6J("ngIf",t.length>0)("ngIfElse",o)}}function ae(i,s){1&i&&(e.TgZ(0,"div",51),e._uU(1," \xa1No hay disponibilidades registradas! "),e.qZA())}const he=[{path:"",component:(()=>{class i{constructor(t,o,r,c,g,v,de){this._activatedRoute=t,this._changeDetectorRef=o,this._fileSaverService=r,this._formBuilder=c,this._fuseConfirmationService=g,this._weightsService=v,this.store=de,this.isUpdate=!1,this.user$=(0,w.of)(null),this.weight=null,this.weights=[],this.weights$=(0,w.of)([]),this._unsubscribeAll=new y.x}ngOnInit(){this.user$=this.store.select(k.rk),this.user$.pipe((0,l.R)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.couriers$=this.store.select(Q.gJ),this.weights$=this.store.select(J.Ql),this.weights$.subscribe(t=>this.weights=t),this.store.select(U.B).pipe((0,l.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.weightForm=this._formBuilder.group({_id:[null],userId:[this.user._id,[a.kI.required]],merchantId:[this.user.merchantId,[a.kI.required]],courierId:[null,[a.kI.required]],month:[F(),[a.kI.required]],availability:[null,[a.kI.required,a.kI.min(0),a.kI.max(99999999),a.kI.maxLength(8)]],type:[null,[a.kI.required]]})}ngAfterViewInit(){this._sort&&this._paginator&&(this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,l.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,T.T)(this._sort.sortChange,this._paginator.page).pipe((0,I.w)(()=>this._weightsService.getWeights(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction))).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}exportAsExcelFile(){this._fileSaverService.exportAsExcelFile(this.weights,"weights")}exportAsCsvFile(){this._fileSaverService.exportAsCsvFile(this.weights,"weights")}saveWeight(){let t=this.weightForm.getRawValue();t=(0,W.omit)(t,["_id"]),this._fuseConfirmationService.open({title:"Crear disponibilidad",message:"\xbfEst\xe1 seguro que todos los datos son correctos?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,l.R)(this._unsubscribeAll)).subscribe(r=>{"confirmed"===r&&this._weightsService.createWeight(t).pipe((0,l.R)(this._unsubscribeAll)).subscribe(()=>{this._fuseConfirmationService.open({title:"Confirmaci\xf3n",message:"Disponibilidad creado correctamente",icon:{show:!0,name:"heroicons_outline:check",color:"success"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1}),this.weightForm.reset(),this.weightForm.get("userId").setValue(this.user._id),this.weightForm.get("merchantId").setValue(this.user.merchantId),this._changeDetectorRef.markForCheck()})}),this._changeDetectorRef.markForCheck()}editWeight(t){this.isUpdate=!0,this.weightForm.patchValue(t),this.weightForm.get("courierId").patchValue(t.courierId._id)}updateWeight(){const t=this.weightForm.getRawValue();this._fuseConfirmationService.open({title:"Actualizar disponibilidad",message:"\xbfEst\xe1 seguro que todos los datos son correctos?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,l.R)(this._unsubscribeAll)).subscribe(r=>{"confirmed"===r&&this._weightsService.updateWeight(t).pipe((0,l.R)(this._unsubscribeAll)).subscribe(()=>{this._fuseConfirmationService.open({title:"Confirmaci\xf3n",message:"disponibilidad actualizado correctamente",icon:{show:!0,name:"heroicons_outline:check",color:"success"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1}),this.isUpdate=!1,this.weightForm.reset(),this.weightForm.get("userId").setValue(this.user._id),this.weightForm.get("merchantId").setValue(this.user.merchantId),this._changeDetectorRef.markForCheck()})}),this._changeDetectorRef.markForCheck()}deleteWeight(t){this._fuseConfirmationService.open({title:"Cuidado",message:"\xbfEst\xe1 seguro que desea eliminar esta disponibilidad?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"warning"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,l.R)(this._unsubscribeAll)).subscribe(r=>{"confirmed"===r&&this._weightsService.deleteWeight(t._id).pipe((0,l.R)(this._unsubscribeAll)).subscribe(c=>{this._fuseConfirmationService.open({title:"Confirmaci\xf3n",message:`${c.message}`,icon:{show:!0,name:"heroicons_outline:check",color:"success"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1}),this._changeDetectorRef.markForCheck()})})}trackByFn(t,o){return o.id||t}monthSelected(t,o){const r=this.weightForm.controls.month.value;r.month(t.month()),r.year(t.year()),this.weightForm.get("month").setValue(r),o.close()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(u.gz),e.Y36(e.sBO),e.Y36(Y.m),e.Y36(a.QS),e.Y36(M.R),e.Y36(A.g),e.Y36(R.yh))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ath-weights"]],viewQuery:function(t,o){if(1&t&&(e.Gf(V,5),e.Gf(b.NW,5),e.Gf(Z.YE,5)),2&t){let r;e.iGM(r=e.CRH())&&(o.htmlWeightList=r.first),e.iGM(r=e.CRH())&&(o._paginator=r.first),e.iGM(r=e.CRH())&&(o._sort=r.first)}},decls:68,vars:34,consts:[["cdkScrollable","","fuseScrollbar","",1,"absolute","inset-0","flex","flex-col","min-w-0","overflow-y-auto"],[1,"flex","flex-col","flex-wrap","p-6","pb-22","sm:pt-12","sm:pb-28","sm:px-10","bg-default","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"whitespace-nowrap","text-primary-500",3,"routerLink"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","flex-wrap","items-center","justify-center","gap-5","mt-6",3,"formGroup","autocomplete"],[1,"fuse-mat-dense","fuse-mat-no-subscript","min-w-40"],["matInput","","required","",3,"matDatepicker","formControlName","placeholder"],["matSuffix","",3,"for"],["startView","year",3,"monthSelected"],["month",""],[4,"ngIf"],["required","",3,"formControlName","placeholder"],[3,"value"],[4,"ngFor","ngForOf"],["matInput","","type","number","min","0","required","",3,"formControlName","placeholder"],["matSuffix",""],[1,"flex-auto","p-6","-mt-16","bg-gray-200","shadow","sm:p-10","rounded-t-2xl"],[1,"w-full","p-16","overflow-auto","shadow","rounded-2xl","bg-card","print:w-auto","print:rounded-none","print:shadow-none","print:bg-transparent"],[1,"flex","items-center","justify-between","mb-5"],[1,"text-2xl","font-semibold","leading-tight"],[1,"-mr-3"],["mat-icon-button","",3,"matMenuTriggerFor"],[1,"icon-size-5",3,"svgIcon"],["xPosition","before"],["listCard01Menu","matMenu"],["mat-menu-item","",3,"click"],["noWeights",""],["mat-button","",1,"rounded-md","bg-primary-500",3,"disabled","click"],[1,"text-white",3,"svgIcon"],[1,"ml-2","mr-1","text-white"],[4,"ngIf","ngIfElse"],["fuseScrollbar","",1,"grid","overflow-auto"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","weight-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[1,"text-center"],[1,"z-10","border-b","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","weight-grid","md:px-8"],[1,"text-center","truncate"],[1,"hidden","text-center","md:block"],[1,"flex","flex-col","items-center","justify-center","gap-1","md:flex-row"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"icon-size-5",3,"svgIcon","matTooltip"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(t,o){if(1&t){const r=e.EpF();e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3)(5,"div")(6,"a",4),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",5),e._UZ(9,"mat-icon",6),e.TgZ(10,"a",7),e._uU(11,"Disponibilidad de Env\xedo"),e.qZA()()(),e.TgZ(12,"div",8)(13,"a",9),e._UZ(14,"mat-icon",6),e.TgZ(15,"span",10),e._uU(16,"Regresar"),e.qZA()()()(),e.TgZ(17,"div",11)(18,"h2",12),e._uU(19," Disponibilidades de env\xedo por meses "),e.qZA()()(),e.TgZ(20,"form",13)(21,"mat-form-field",14),e._UZ(22,"input",15),e.TgZ(23,"mat-hint"),e._uU(24,"MM/YYYY"),e.qZA(),e._UZ(25,"mat-datepicker-toggle",16),e.TgZ(26,"mat-datepicker",17,18),e.NdJ("monthSelected",function(g){e.CHM(r);const v=e.MAs(27);return e.KtG(o.monthSelected(g,v))}),e.qZA(),e.YNc(28,$,2,0,"mat-error",19),e.qZA(),e.TgZ(29,"mat-form-field",14)(30,"mat-select",20)(31,"mat-option",21),e._uU(32,"Seleccione un operador"),e.qZA(),e.YNc(33,z,3,2,"ng-container",22),e.ALo(34,"async"),e.qZA(),e.YNc(35,G,2,0,"mat-error",19),e.qZA(),e.TgZ(36,"mat-form-field",14)(37,"mat-select",20),e._UZ(38,"mat-option",21),e.TgZ(39,"mat-option",21),e._uU(40,"A\xe9reo"),e.qZA(),e.TgZ(41,"mat-option",21),e._uU(42,"Mar\xedtimo"),e.qZA()(),e.YNc(43,j,2,0,"mat-error",19),e.qZA(),e.TgZ(44,"mat-form-field",14),e._UZ(45,"input",23),e.TgZ(46,"span",24),e._uU(47,"kg"),e.qZA(),e.YNc(48,H,2,0,"mat-error",19),e.qZA(),e.YNc(49,K,5,2,"ng-container",19),e.YNc(50,P,5,2,"ng-container",19),e.qZA()(),e.TgZ(51,"div",25)(52,"div",26)(53,"div",27),e._UZ(54,"div",28),e.TgZ(55,"div",29)(56,"button",30),e._UZ(57,"mat-icon",31),e.qZA(),e.TgZ(58,"mat-menu",32,33)(60,"button",34),e.NdJ("click",function(){return o.exportAsExcelFile()}),e._uU(61,"Exportar a Excel"),e.qZA(),e.TgZ(62,"button",34),e.NdJ("click",function(){return o.exportAsCsvFile()}),e._uU(63,"Exportar a CSV"),e.qZA()()()(),e.YNc(64,se,2,2,"ng-container",19),e.ALo(65,"async"),e.YNc(66,ae,2,0,"ng-template",null,35,e.W1O),e.qZA()()()}if(2&t){const r=e.MAs(27),c=e.MAs(59);e.xp6(6),e.Q6J("routerLink","/home"),e.xp6(3),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:chevron-left"),e.xp6(6),e.Q6J("formGroup",o.weightForm)("autocomplete","off"),e.xp6(2),e.Q6J("matDatepicker",r)("formControlName","month")("placeholder","Mes"),e.xp6(3),e.Q6J("for",r),e.xp6(3),e.Q6J("ngIf",o.weightForm.get("month").hasError("required")&&o.weightForm.get("month").touched),e.xp6(2),e.Q6J("formControlName","courierId")("placeholder","Operador"),e.xp6(1),e.Q6J("value",""),e.xp6(2),e.Q6J("ngForOf",e.lcZ(34,30,o.couriers$)),e.xp6(2),e.Q6J("ngIf",o.weightForm.get("courierId").hasError("required")&&o.weightForm.get("courierId").touched),e.xp6(2),e.Q6J("formControlName","type")("placeholder","Tipo de disponibilidad"),e.xp6(1),e.Q6J("value",""),e.xp6(1),e.Q6J("value","A\xe9reo"),e.xp6(2),e.Q6J("value","Mar\xedtimo"),e.xp6(2),e.Q6J("ngIf",o.weightForm.get("type").hasError("required")&&o.weightForm.get("type").touched),e.xp6(2),e.Q6J("formControlName","availability")("placeholder","Disponibilidad"),e.xp6(3),e.Q6J("ngIf",o.weightForm.get("availability").hasError("required")&&o.weightForm.get("availability").touched),e.xp6(1),e.Q6J("ngIf",!o.isUpdate),e.xp6(1),e.Q6J("ngIf",o.isUpdate),e.xp6(6),e.Q6J("matMenuTriggerFor",c),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:dots-vertical"),e.xp6(7),e.Q6J("ngIf",e.lcZ(65,32,o.weights$))}},dependencies:[u.yS,h.mk,h.sg,h.O5,a._Y,a.Fj,a.wV,a.JJ,a.JL,a.Q7,a.qQ,a.sg,a.u,E.PQ,m.ey,N.lW,p.Mq,p.hl,p.nW,q.Hw,d.TO,d.KE,d.bx,d.R9,D.Nt,f.VK,f.OP,f.p6,b.NW,L.gD,Z.YE,B.gM,O.H,h.Ov,h.JJ,h.uU],encapsulation:2,data:{animation:S.L},changeDetection:0}),i})(),resolve:{couriers:n(2077).O,weights:(()=>{class i{constructor(t){this._weightsService=t}resolve(t,o){return this._weightsService.getWeights()}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(A.g))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})()}}];let me=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({providers:[{provide:m._A,useClass:x.t7,deps:[m.Ad,x.o8]},{provide:m.sG,useValue:{parse:{dateInput:"MM/YYYY"},display:{dateInput:"MM/YYYY",monthYearLabel:"MMM YYYY",dateA11yLabel:"LL",monthYearA11yLabel:"MMMM YYYY"}}}],imports:[u.Bz.forChild(he),C.m]}),i})()}}]);